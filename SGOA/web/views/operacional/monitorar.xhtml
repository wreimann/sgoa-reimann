<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">  
<ui:composition xmlns="http://www.w3.org/1999/xhtml" 
                template="./../../template/form.xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core" 
                xmlns:p="http://primefaces.org/ui">

    <ui:define name="Navagador">
        <a class="current">Operacional</a>
        <div class="breadcrumb_divider"></div> 
        <a class="current">Monitorar pátio</a>
    </ui:define>

    <ui:define name="Titulo">
        <h2>Monitorar pátio</h2>
    </ui:define>

    <ui:define name="Conteudo">
        <h:form id="frmPesquisa" prependId="false">
            <p:focus context="frmPesquisa"/>
            <h:panelGrid columns="2">
                <p:fieldset id="NumeroPesquisaField" style="width: 190px; margin-right: 19px;">
                    <p:outputLabel id="NumeroPesquisaLabel" value="Orçamento"/>
                    <p:inputMask id="NumeroPesquisaInput"
                                 value="#{monitorarPatioController.numero}" mask="9999.9?999" />
                </p:fieldset>
                <p:fieldset id="SituacaoPesquisaField" style="width: 195px;">
                    <p:outputLabel id="SituacaoPesquisaLabel" value="Situação"/>
                    <p:selectOneMenu id="SituacaoPesquisaListBox" styleClass="selectOneMenu"
                                     value="#{monitorarPatioController.situacaoFiltro}" >
                        <f:selectItem itemLabel="Em Execução" itemValue="E" />
                        <f:selectItem itemLabel="Parado" itemValue="P" />
                        <f:selectItem itemLabel="Fila de espera" itemValue="F" />
                    </p:selectOneMenu>
                </p:fieldset>
            </h:panelGrid>
            <h:panelGrid columns="2">
                <p:fieldset id="ClientePesquisaField" style="width: 490px; margin-right: 19px;">
                    <p:outputLabel id="ClientePesquisaLabel" value="Cliente"/>
                    <p:autoComplete value="#{monitorarPatioController.clienteFiltro}" id="ClientePesquisaInput"
                                    completeMethod="#{monitorarPatioController.selecionarClienteAutoComplete}"
                                    var="cliente" effect="fade"
                                    itemLabel="#{cliente.pessoa.nome}" itemValue="#{cliente}"
                                    converter="clienteConverter" forceSelection="true" />
                </p:fieldset>
                <p:fieldset id="PlacaPesquisaField" style="width: 190px;" >
                    <p:outputLabel id="PlacaPesquisaLabel" value="Placa"/>
                    <p:inputMask id="PlacaPesquisaInput" mask="aaa9999" value="#{monitorarPatioController.placaFiltro}"
                                 style="text-transform: uppercase;"/>
                </p:fieldset>
            </h:panelGrid>
            <h:panelGrid columns="2">
                <p:fieldset id="AtividadeField" style="width: 340px;" >
                    <label id="AtividadeLabel">Atividade</label>
                    <h:selectOneMenu id="AtividadeFieldListBox" 
                                     value="#{monitorarPatioController.atividadeFiltro}" 
                                     converter="etapaConverter" >
                        <f:selectItem itemValue="#{null}" itemLabel="Selecione..." noSelectionOption="true" />
                        <f:selectItems value="#{monitorarPatioController.etapas}" var="etapa"
                                       itemLabel="#{etapa}" itemValue="#{etapa}"/>
                    </h:selectOneMenu>
                </p:fieldset>
                <p:fieldset id="SetorField" style="width: 340px; margin-left: 19px;" >
                    <label id="SetorLabel">Setor</label>
                    <h:selectOneMenu id="SetorFieldListBox" 
                                     value="#{monitorarPatioController.setorFiltro}" 
                                     converter="setorConverter" >
                        <f:selectItem itemValue="#{null}" itemLabel="Selecione..." noSelectionOption="true" />
                        <f:selectItems value="#{monitorarPatioController.setores}" var="setor"
                                       itemLabel="#{setor}" itemValue="#{setor}"/>
                    </h:selectOneMenu>
                </p:fieldset>
            </h:panelGrid>
            <p:commandButton id="btnPesquisar" value="Pesquisar" update="messages, :frmPesquisa" title="Pesquisar"/>
            <p:commandButton id="btnLimparPesquisa" value="Limpar" update=":frmPesquisa" action="#{monitorarPatioController.limparCampos}" />
            <p:messages id="messages" autoUpdate="true" closable="true"  />

            <div class="spacer"></div>
            <p:dataTable id="dataTable" var="item"
                         value="#{monitorarPatioController.lazyModel}" lazy="true"
                         paginator="true" paginatorPosition="bottom"
                         emptyMessage="Nenhum resultado encontrado."
                         rows="#{monitorarPatioController.pageSize}"
                         currentPageReportTemplate="Tota de Registros: {totalRecords} - Página: {currentPage}/{totalPages}"
                         paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}" >
                <f:facet name="header">
                    <div class="tabs_involved">
                        <h:outputLabel value="Monitorar pátio" styleClass="tabs_involved" />
                    </div>
                </f:facet>
                <p:column headerText="Ações" width="35">
                    <p:commandButton  alt="Editar" title="Editar" icon="btn_editar" 
                                      action="#{monitorarPatioController.editar}">
                        <f:setPropertyActionListener value="#{item}" target="#{monitorarPatioController.current}" /> 
                    </p:commandButton>
                </p:column>
                <p:column sortBy="#{item.dataCadastro}" headerText="Data Cadastro">
                    <h:outputText value="#{item.dataCadastro}" >
                        <f:convertDateTime type="date" pattern="dd/MM/yyyy" timeZone="America/Sao_Paulo" />
                    </h:outputText>
                </p:column>
                <p:column sortBy="#{item.ordemServico.orcamento.ano}" headerText="Orçamento" width="60" >
                    <h:outputText value="#{item.ordemServico.orcamento}" />
                </p:column>
                <p:column sortBy="#{item.ordemServico.orcamento.cliente}" headerText="Cliente">
                    <h:outputText value="#{item.ordemServico.orcamento.cliente.pessoa.nome}" />
                </p:column>
                <p:column sortBy="#{item.ordemServico.orcamento.veiculo}" headerText="Veículo">
                    <h:outputText value="#{item.ordemServico.orcamento.veiculo}" />
                </p:column>
                <p:column sortBy="#{item.etapa}" headerText="Atividade">
                    <h:outputText value="#{item.etapa}" />
                </p:column>
                <p:column sortBy="#{item.etapa.setor}" headerText="Setor">
                    <h:outputText value="#{item.etapa.setor}" />
                </p:column>
                <p:column sortBy="#{item.funcionario}" headerText="Funcionário">
                    <h:outputText value="#{item.funcionario}" />
                </p:column>
                <p:column sortBy="#{item.situacao}" headerText="Situação">
                    <p:outputLabel value="Em Execução" rendered="#{item.situacao == 'E'}"   />  
                    <p:outputLabel value="Parado" rendered="#{item.situacao == 'P'}"   />  
                    <p:outputLabel value="Fila de espera" rendered="#{item.situacao == 'F'}"   />  
                </p:column>
            </p:dataTable>
        </h:form>
    </ui:define>

    <ui:define name="Rodape">
    </ui:define>

</ui:composition>
