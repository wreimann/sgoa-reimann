<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                template="./../../template/form.xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core">

    <ui:define name="Navagador">
        <a class="current">Operacional</a>
        <div class="breadcrumb_divider"></div> 
        <a class="current">Controle de Serviços</a>
    </ui:define>

    <ui:define name="Titulo">
        <h2>Controle de Serviços</h2>
    </ui:define>

    <ui:define name="Conteudo">
        <h:form id="frmCadastro"> 
            <p:messages id="messages" autoUpdate="true" closable="true"  />
            <h:panelGrid columns="2">
                <p:fieldset id="PlacaPesquisaField" style="width: 150px;" >
                    <p:outputLabel id="PlacaPesquisaLabel" value="Placa *"/>
                    <p:inputMask id="PlacaPesquisaInput" mask="aaa9999" value="#{ordemServicoController.placa}"
                                 style="text-transform: uppercase;">
                        <p:ajax event="change" update=":frmCadastro" 
                                listener="#{ordemServicoController.changePlaca}" immediate="true" />
                    </p:inputMask>
                    <p:commandButton id="btnLocalizarOS" value="Localizar" />
                </p:fieldset>
                <p:fieldset id="ClientePesquisaField" style="width: 500px; margin-right: 19px;">
                    <p:outputLabel id="ClientePesquisaLabel" value="Cliente"/>
                    <h:outputText value="#{ordemServicoController.cliente}"  />
                </p:fieldset>
            </h:panelGrid>
            <h:panelGrid columns="2">
                <p:fieldset id="FluxoField" >
                    <label id="FluxoLabel">Fluxo de Trabalho</label>
                    <h:outputText value="#{ordemServicoController.fluxo}"  />
                    <p:commandButton id="btnRemoverFluxo" value="Remover" />  
                </p:fieldset>
                <p:fieldset id="EtapaAtualField" >
                    <label id="EtapaLabel">Etapa*</label>
                    <h:selectOneMenu id="EtapaAtualListBox" style="width: 480px!important;"
                                     value="#{ordemServicoController.current.etapa}" 
                                     converter="etapaConverter" >
                        <f:selectItem itemValue="#{null}" itemLabel="Selecione..." noSelectionOption="true" />
                        <f:selectItems value="#{ordemServicoController.etapasAtivas}" var="etapa"
                                       itemLabel="#{etapa}" itemValue="#{etapa}"/>
                    </h:selectOneMenu>
                </p:fieldset>
            </h:panelGrid>
            <h:panelGrid columns="3">
                <p:fieldset id="DataConclusaoField" style="width: 190px;margin-right: 19px;">
                    <p:outputLabel id="DataConclusaoLabel" value="Data Conclusão*"/>
                    <p:calendar showButtonPanel="true" navigator="true" id="DataConclusao"
                                value="#{ordemServicoController.current.dataSaida}" 
                                converterMessage="Valor inválido!"
                                pattern="dd/MM/yyyy" />
                </p:fieldset>
                <p:fieldset id="HorasTrabalhadaField" style="width: 260px; float: left; margin-left: 19px;" >
                    <label id="HorasTrabalhadaLabel">Horas trabalhadas *</label>
                    <p:inputText id="HorasTrabalhadaText" value="#{ordemServicoController.current.horasTrabalhadas}" >
                        <f:convertNumber pattern="#,##0.00" minFractionDigits="2" maxFractionDigits="2" 
                                         type="currency" />
                    </p:inputText>
                </p:fieldset>
                <p:fieldset id="FuncionarioField" style="width: 552px; display: inline-block; margin-left: 19px;">
                    <label id="FuncionarioLabel">Funcionário *</label>
                    <h:selectOneMenu id="FuncionarioListBox" style="width: 480px!important;"
                                     value="#{ordemServicoController.current.funcionario}" 
                                     converter="funcionarioConverter" >
                        <f:selectItem itemValue="#{null}" itemLabel="Selecione..." noSelectionOption="true" />
                        <f:selectItems value="#{ordemServicoController.funcionariosAtivos}" var="funcionario"
                                       itemLabel="#{funcionario}" itemValue="#{funcionario}"/>
                    </h:selectOneMenu>
                </p:fieldset>
            </h:panelGrid>

            <p:fieldset id="ObsField">
                <label id="ObsLabel">Observação</label>
                <p:inputTextarea id="ObsInput" value="#{ordemServicoController.current.obs}"/>
            </p:fieldset>

            <p:fileUpload fileUploadListener="#{ordemServicoController.handleFileUpload}" 
                          showButtons="false" label="Procurar..." auto="true" 
                          sizeLimit="3000000" allowTypes="/(\.|\/)(pdf|doc?x)$/"
                          update=":frmCadastro"
                          dragDropSupport="false" mode="advanced" />



            <h:panelGroup id="pnlToolbar" layout="block" style="margin-top: 10px" >
                <p:commandButton id="btnSalvar"
                                 actionListener="#{ordemServicoController.salvar}"
                                 update=":frmCadastro" value="Salvar" />
                <p:commandButton id="btnCancelar" value="Cancelar"
                                 actionListener="#{ordemServicoController.limparCampos}"
                                 update=":frmCadastro" />
            </h:panelGroup>

        </h:form>


    </ui:define>

    <ui:define name="Rodape">
    </ui:define>

</ui:composition>
